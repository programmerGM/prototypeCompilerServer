var tabelaParse = [{
  p1: 48,
  p2: 2,
  valor: 1
},
{
  p1: 49,
  p2: 2,
  valor: 3
},
{
  p1: 49,
  p2: 3,
  valor: 3
},
{
  p1: 49,
  p2: 7,
  valor: 2
},
{
  p1: 49,
  p2: 12,
  valor: 3
},
{
  p1: 49,
  p2: 13,
  valor: 3
},
{
  p1: 49,
  p2: 17,
  valor: 3
},
{
  p1: 49,
  p2: 23,
  valor: 3
},
{
  p1: 49,
  p2: 44,
  valor: 3
},
{
  p1: 50,
  p2: 2,
  valor: 13
},
{
  p1: 50,
  p2: 3,
  valor: 13
},
{
  p1: 50,
  p2: 12,
  valor: 13
},
{
  p1: 50,
  p2: 13,
  valor: 19
},
{
  p1: 50,
  p2: 17,
  valor: 13
},
{
  p1: 50,
  p2: 23,
  valor: 13
},
{
  p1: 51,
  p2: 13,
  valor: 31
},
{
  p1: 52,
  p2: 38,
  valor: 4
},
{
  p1: 52,
  p2: 40,
  valor: 5
},
{
  p1: 53,
  p2: 3,
  valor: 8
},
{
  p1: 53,
  p2: 12,
  valor: 6
},
{
  p1: 53,
  p2: 17,
  valor: 7
},
{
  p1: 53,
  p2: 23,
  valor: 9
},
{
  p1: 54,
  p2: 2,
  valor: 10
},
{
  p1: 54,
  p2: 3,
  valor: 10
},
{
  p1: 54,
  p2: 7,
  valor: 11
},
{
  p1: 54,
  p2: 12,
  valor: 10
},
{
  p1: 54,
  p2: 13,
  valor: 10
},
{
  p1: 54,
  p2: 17,
  valor: 10
},
{
  p1: 54,
  p2: 23,
  valor: 10
},
{
  p1: 54,
  p2: 44,
  valor: 10
},
{
  p1: 55,
  p2: 7,
  valor: 12
},
{
  p1: 56,
  p2: 2,
  valor: 15
},
{
  p1: 56,
  p2: 3,
  valor: 18
},
{
  p1: 56,
  p2: 12,
  valor: 14
},
{
  p1: 56,
  p2: 17,
  valor: 17
},
{
  p1: 56,
  p2: 23,
  valor: 16
},
{
  p1: 57,
  p2: 36,
  valor: 26
},
{
  p1: 57,
  p2: 43,
  valor: 27
},
{
  p1: 58,
  p2: 5,
  valor: 20
},
{
  p1: 58,
  p2: 6,
  valor: 21
},
{
  p1: 58,
  p2: 7,
  valor: 22
},
{
  p1: 58,
  p2: 8,
  valor: 23
},
{
  p1: 58,
  p2: 9,
  valor: 24
},
{
  p1: 58,
  p2: 42,
  valor: 25
},
{
  p1: 59,
  p2: 3,
  valor: 28
},
{
  p1: 59,
  p2: 12,
  valor: 28
},
{
  p1: 59,
  p2: 17,
  valor: 28
},
{
  p1: 59,
  p2: 23,
  valor: 28
},
{
  p1: 60,
  p2: 37,
  valor: 29
},
{
  p1: 60,
  p2: 42,
  valor: 30
},
{
  p1: 61,
  p2: 1,
  valor: 52
},
{
  p1: 61,
  p2: 5,
  valor: 37
},
{
  p1: 61,
  p2: 6,
  valor: 37
},
{
  p1: 61,
  p2: 7,
  valor: 37
},
{
  p1: 61,
  p2: 8,
  valor: 37
},
{
  p1: 61,
  p2: 9,
  valor: 37
},
{
  p1: 61,
  p2: 14,
  valor: 49
},
{
  p1: 61,
  p2: 16,
  valor: 64
},
{
  p1: 61,
  p2: 20,
  valor: 67
},
{
  p1: 61,
  p2: 21,
  valor: 69
},
{
  p1: 61,
  p2: 22,
  valor: 68
},
{
  p1: 61,
  p2: 24,
  valor: 39
},
{
  p1: 61,
  p2: 37,
  valor: 38
},
{
  p1: 61,
  p2: 43,
  valor: 37
},
{
  p1: 62,
  p2: 18,
  valor: 32 //atualizado aqui
},
{
  p1: 62,
  p2: 35,
  valor: 33
},
{
  p1: 63,
  p2: 5,
  valor: 75
},
{
  p1: 63,
  p2: 6,
  valor: 75
},
{
  p1: 63,
  p2: 7,
  valor: 75
},
{
  p1: 63,
  p2: 8,
  valor: 75
},
{
  p1: 63,
  p2: 9,
  valor: 75
},
{
  p1: 63,
  p2: 24,
  valor: 76
},
{
  p1: 63,
  p2: 43,
  valor: 75
},
{
  p1: 64,
  p2: 29,
  valor: 40
},
{
  p1: 64,
  p2: 37,
  valor: 40
},
{
  p1: 64,
  p2: 42,
  valor: 40
},
{
  p1: 64,
  p2: 43,
  valor: 41
},
{
  p1: 65,
  p2: 5,
  valor: 44
},
{
  p1: 65,
  p2: 6,
  valor: 46
},
{
  p1: 65,
  p2: 7,
  valor: 48
},
{
  p1: 65,
  p2: 8,
  valor: 47
},
{
  p1: 65,
  p2: 9,
  valor: 45
},
{
  p1: 66,
  p2: 40,
  valor: 43
},
{
  p1: 66,
  p2: 42,
  valor: 42
},
{
  p1: 67,
  p2: 26,
  valor: 56
},
{
  p1: 67,
  p2: 27,
  valor: 55
},
{
  p1: 67,
  p2: 28,
  valor: 53
},
{
  p1: 67,
  p2: 30,
  valor: 58
},
{
  p1: 67,
  p2: 32,
  valor: 57
},
{
  p1: 67,
  p2: 45,
  valor: 54
},
{
  p1: 68,
  p2: 19,
  valor: 50
},
{
  p1: 68,
  p2: 37,
  valor: 51
},
{
  p1: 69,
  p2: 5,
  valor: 59
},
{
  p1: 69,
  p2: 6,
  valor: 60
},
{
  p1: 69,
  p2: 7,
  valor: 63
},
{
  p1: 69,
  p2: 8,
  valor: 62
},
{
  p1: 69,
  p2: 9,
  valor: 61
},
{
  p1: 70,
  p2: 33,
  valor: 65
},
{
  p1: 70,
  p2: 46,
  valor: 66
},
{
  p1: 71,
  p2: 31,
  valor: 72
},
{
  p1: 71,
  p2: 37,
  valor: 70
},
{
  p1: 72,
  p2: 31,
  valor: 73
},
{
  p1: 72,
  p2: 37,
  valor: 73
},
{
  p1: 72,
  p2: 40,
  valor: 74
},
{
  p1: 73,
  p2: 5,
  valor: 80
},
{
  p1: 73,
  p2: 6,
  valor: 80
},
{
  p1: 73,
  p2: 7,
  valor: 80
},
{
  p1: 73,
  p2: 8,
  valor: 80
},
{
  p1: 73,
  p2: 9,
  valor: 80
},
{
  p1: 73,
  p2: 43,
  valor: 80
},
{
  p1: 74,
  p2: 29,
  valor: 79
},
{
  p1: 74,
  p2: 34,
  valor: 77
},
{
  p1: 74,
  p2: 37,
  valor: 79
},
{
  p1: 74,
  p2: 42,
  valor: 79
},
{
  p1: 74,
  p2: 47,
  valor: 78
},
{
  p1: 75,
  p2: 5,
  valor: 84
},
{
  p1: 75,
  p2: 6,
  valor: 85
},
{
  p1: 75,
  p2: 7,
  valor: 86
},
{
  p1: 75,
  p2: 8,
  valor: 88
},
{
  p1: 75,
  p2: 9,
  valor: 87
},
{
  p1: 75,
  p2: 43,
  valor: 89
},
{
  p1: 76,
  p2: 29,
  valor: 81
},
{
  p1: 76,
  p2: 34,
  valor: 81
},
{
  p1: 76,
  p2: 37,
  valor: 81
},
{
  p1: 76,
  p2: 39,
  valor: 83
},
{
  p1: 76,
  p2: 41,
  valor: 82
},
{
  p1: 76,
  p2: 42,
  valor: 81
},
{
  p1: 76,
  p2: 47,
  valor: 81
}
],
  producoes = [{
    code: 48,
    sentence: [2, 10, 36, 49, 50, 51, 35]
  }, {
    code: 49,
    sentence: [7, 52, 38, 53, 37, 54]
  }, {
    code: 49,
    sentence: [15]
  }, {
    code: 52,
    sentence: [15]
  }, {
    code: 52,
    sentence: [40, 7, 52]
  }, {
    code: 53,
    sentence: [12]
  }, {
    code: 53,
    sentence: [17]
  }, {
    code: 53,
    sentence: [3]
  }, {
    code: 53,
    sentence: [23]
  }, {
    code: 54,
    sentence: [15]
  }, {
    code: 54,
    sentence: [55, 38, 53, 37, 54]
  }, {
    code: 55,
    sentence: [7, 52]
  }, {
    code: 50,
    sentence: [56, 7, 57, 36, 49, 50, 51, 4, 43, 58, 42, 35, 50]
  }, {
    code: 56,
    sentence: [12]
  }, {
    code: 56,
    sentence: [2]
  }, {
    code: 56,
    sentence: [23]
  }, {
    code: 56,
    sentence: [17]
  }, {
    code: 56,
    sentence: [3]
  }, {
    code: 50,
    sentence: [15]
  }, {
    code: 58,
    sentence: [5]
  }, {
    code: 58,
    sentence: [6]
  }, {
    code: 58,
    sentence: [7]
  }, {
    code: 58,
    sentence: [8]
  }, {
    code: 58,
    sentence: [9]
  }, {
    code: 58,
    sentence: [15]
  }, {
    code: 57,
    sentence: [15]
  }, {
    code: 57,
    sentence: [43, 59, 42]
  }, {
    code: 59,
    sentence: [53, 60]
  }, {
    code: 60,
    sentence: [37, 53, 60]
  }, {
    code: 60,
    sentence: [15]
  }, {
    code: 51,
    sentence: [13, 61, 37, 62, 18]
  }, {
    code: 62,
    sentence: [15]
  }, {
    code: 62,
    sentence: [61, 37, 62]
  }, {
    code: 61,
    sentence: [7, 29, 63]
  }, {
    code: 61,
    sentence: [9, 29, 63]
  }, {
    code: 61,
    sentence: [8, 29, 63]
  }, {
    code: 61,
    sentence: [63, 29, 63]
  }, {
    code: 61,
    sentence: [15, 7]
  }, {
    code: 61,
    sentence: [24, 7, 64]
  }, {
    code: 64,
    sentence: [15]
  }, {
    code: 64,
    sentence: [43, 65, 66, 42]
  }, {
    code: 66,
    sentence: [15]
  }, {
    code: 66,
    sentence: [40, 65, 66]
  }, {
    code: 65,
    sentence: [5]
  }, {
    code: 65,
    sentence: [9]
  }, {
    code: 65,
    sentence: [6]
  }, {
    code: 65,
    sentence: [8]
  }, {
    code: 65,
    sentence: [7]
  }, {
    code: 61,
    sentence: [14, 43, 7, 67, 42, 36, 61, 37, 62, 35, 68] // atualizado aqui
  }, {
    code: 68,
    sentence: [19, 36, 61, 37, 62, 35]
  }, {
    code: 68,
    sentence: [15]
  }, {
    code: 61,
    sentence: [1, 43, 7, 67, 42, 36, 61, 37, 62, 35]
  }, {
    code: 67,
    sentence: [28, 69]
  }, {
    code: 67,
    sentence: [45, 69]
  }, {
    code: 67,
    sentence: [27, 69]
  }, {
    code: 67,
    sentence: [26, 69]
  }, {
    code: 67,
    sentence: [32, 69]
  }, {
    code: 67,
    sentence: [30, 69]
  }, {
    code: 69,
    sentence: [5]
  }, {
    code: 69,
    sentence: [6]
  }, {
    code: 69,
    sentence: [9]
  }, {
    code: 69,
    sentence: [8]
  }, {
    code: 69,
    sentence: [7]
  }, {
    code: 61,
    sentence: [16, 43, 7, 29, 69, 37, 7, 67, 37, 70, 42, 36, 61, 37, 62, 35]
  }, {
    code: 70,
    sentence: [33, 5]
  }, {
    code: 70,
    sentence: [46, 5]
  }, {
    code: 61,
    sentence: [20, 36, 61, 37, 62, 35, 1, 43, 7, 67, 42]
  }, {
    code: 61,
    sentence: [22, 25, 7]
  }, {
    code: 61,
    sentence: [21, 31, 11, 71]
  }, {
    code: 71,
    sentence: [15]
  }, {
    code: 71,
    sentence: [31, 7, 72, 71]
  }, {
    code: 71,
    sentence: [31, 11, 71]
  }, {
    code: 72,
    sentence: [15]
  }, {
    code: 72,
    sentence: [40, 7, 72]
  }, {
    code: 63,
    sentence: [73, 74]
  }, {
    code: 63,
    sentence: [24, 7, 64]
  }, {
    code: 74,
    sentence: [34, 73, 74]
  }, {
    code: 74,
    sentence: [47, 73, 74]
  }, {
    code: 74,
    sentence: [15]
  }, {
    code: 73,
    sentence: [75, 7, 6, 8]
  }, {
    code: 76,
    sentence: [15]
  }, {
    code: 76,
    sentence: [41, 75, 76]
  }, {
    code: 76,
    sentence: [39, 75, 76]
  }, {
    code: 75,
    sentence: [5]
  }, {
    code: 75,
    sentence: [6]
  }, {
    code: 75,
    sentence: [7]
  }, {
    code: 75,
    sentence: [9]
  }, {
    code: 75,
    sentence: [8]
  }, {
    code: 75,
    sentence: [43, 63, 42]
  }],

  //Lista de não terminais
  nterm = [{
    code: 48,
    nterm: ' BLOCO'
  },
  {
    code: 49,
    nterm: 'DCLVAR'
  },
  {
    code: 50,
    nterm: 'DCLFUNC'
  },
  {
    code: 51,
    nterm: 'CORPO'
  },
  {
    code: 52,
    nterm: 'REPIDENT'
  },
  {
    code: 53,
    nterm: 'TIPO'
  },
  {
    code: 54,
    nterm: 'LDVAR'
  },
  {
    code: 55,
    nterm: 'LID'
  },
  {
    code: 56,
    nterm: 'TIPO_RETORNO'
  },
  {
    code: 57,
    nterm: 'DEFPAR'
  },
  {
    code: 58,
    nterm: 'VALORRETORNO'
  },
  {
    code: 59,
    nterm: 'PARAM'
  },
  {
    code: 60,
    nterm: 'LPARAM'
  },
  {
    code: 61,
    nterm: 'COMANDO'
  },
  {
    code: 62,
    nterm: 'REPCOMANDO'
  },
  {
    code: 63,
    nterm: 'EXPRESSAO'
  },
  {
    code: 64,
    nterm: 'PARAMETROS'
  },
  {
    code: 65,
    nterm: 'TPARAM'
  },
  {
    code: 66,
    nterm: 'REPPAR'
  },
  {
    code: 67,
    nterm: 'COMPARACAO'
  },
  {
    code: 68,
    nterm: 'ELSEPARTE'
  },
  {
    code: 69,
    nterm: 'CONTCOMPARACAO'
  },
  {
    code: 70,
    nterm: 'INCREMENTO'
  },
  {
    code: 71,
    nterm: 'SEQCOUT'
  },
  {
    code: 72,
    nterm: 'SEQUENCIA'
  },
  {
    code: 73,
    nterm: 'TERMO'
  },
  {
    code: 74,
    nterm: 'REPEXP'
  },
  {
    code: 75,
    nterm: 'FATOR'
  },
  {
    code: 76,
    nterm: 'REPTERMO'
  },
  {
    code: 48,
    nterm: ' BLOCO'
  },
  {
    code: 49,
    nterm: 'DCLVAR'
  },
  {
    code: 50,
    nterm: 'DCLFUNC'
  },
  {
    code: 51,
    nterm: 'CORPO'
  },
  {
    code: 52,
    nterm: 'REPIDENT'
  },
  {
    code: 53,
    nterm: 'TIPO'
  },
  {
    code: 54,
    nterm: 'LDVAR'
  },
  {
    code: 55,
    nterm: 'LID'
  },
  {
    code: 56,
    nterm: 'TIPO_RETORNO'
  },
  {
    code: 57,
    nterm: 'DEFPAR'
  },
  {
    code: 58,
    nterm: 'VALORRETORNO'
  },
  {
    code: 59,
    nterm: 'PARAM'
  },
  {
    code: 60,
    nterm: 'LPARAM'
  },
  {
    code: 61,
    nterm: 'COMANDO'
  },
  {
    code: 62,
    nterm: 'REPCOMANDO'
  },
  {
    code: 63,
    nterm: 'EXPRESSAO'
  },
  {
    code: 64,
    nterm: 'PARAMETROS'
  },
  {
    code: 65,
    nterm: 'TPARAM'
  },
  {
    code: 66,
    nterm: 'REPPAR'
  },
  {
    code: 67,
    nterm: 'COMPARACAO'
  },
  {
    code: 68,
    nterm: 'ELSEPARTE'
  },
  {
    code: 69,
    nterm: 'CONTCOMPARACAO'
  },
  {
    code: 70,
    nterm: 'INCREMENTO'
  },
  {
    code: 71,
    nterm: 'SEQCOUT'
  },
  {
    code: 72,
    nterm: 'SEQUENCIA'
  },
  {
    code: 73,
    nterm: 'TERMO'
  },
  {
    code: 74,
    nterm: 'REPEXP'
  },
  {
    code: 75,
    nterm: 'FATOR'
  },
  {
    code: 76,
    nterm: 'REPTERMO'
  }
  ];

module.exports.sintatico = function (application, req, res, tokens) {
  sintaticoExecuta(tokens)
}

function sintaticoExecuta(tokens) {

  var codigos  = []

  for(var a = 0; a < tokens.length; a++){
    codigos.push(tokens[a].code)
    console.log(codigos[a])
  }

  var top = 44,
    entrada = 3,
    pilha = codigos;


  while (!pilha) {
    if (!!top) { // se for null, NaN ou undefined, então é falso - antes estava if(top != null)
      pilha.shift(); // remove primeiro elemento
      top = pilha[0]; // recebe o topo da pilha
      continue;
    }
    // senão
    if (isTerminal(top)) { // se for terminal
      if (top === entrada) { // termina
        pilha.shift();
        top = pilha[0]; // recebe o topo da pilha
        continue;
      }
      //senão erro
      console.log('errow');
      break;
    }
    // se não for terminal
    var tab = findTabela(top, entrada);
    if (tab != 0) {
      pilha.shift(); // remove elemento do topo da pilha
      // coloque o conteudo na pilha
      if (tab.length > 1) {
        tab.forEach((value) => {
          pilha.push(value);
        });
      }
      top = pilha[0]; // recebe topo da pilha
    } else {
      // erro encerra programa
      console.log('errow');
      break;
    }
  }
}